jQuery(function($){JBZoo.widget('HyperPC.SiteCategoryFps',{},{init:function($this){var $gameControl=$this.$('.jsFpsControl').find('.jsFpsGameSelect'),gamesCount=$gameControl.find('option').length,rand=Math.floor(Math.random()*gamesCount);if(rand>0){$gameControl.find('option').eq(rand).attr('selected','selected');}$this.$('.jsFpsGameImg').attr('src',$gameControl.find('option:selected').data('img'));$this._updateFps($this);},_updateFps:function($this){var state=$this._getFpsState($this);$this.$('.jsProductTeaserFps').each(function(){var $teaserFps=$(this),fps=$teaserFps.data('fps'),game=state['game'],quality=state['quality'],resolution=state['resolution'],topLimit=200;if(fps[game]&&fps[game][quality][resolution]!==0){var barHeight=100-((topLimit-fps[game][quality][resolution])/(topLimit*0.01));$teaserFps.find('.hp-product-teaser-fps__clip, .jsFpsCounter').css('bottom',Math.min(barHeight,100)+'%');$teaserFps.find('.hp-product-teaser-fps__bar').css('clip-path','inset('+(100-barHeight)+'% 0 0)').css('-webkit-clip-path','inset('+(100-barHeight)+'% 0 0)');$teaserFps.find('.jsFpsCounter').animate({'opacity':0.25},250,function(){$(this).html(fps[game][quality][resolution]).animate({'opacity':1},250);});}else{$teaserFps.find('.hp-product-teaser-fps__clip, .jsFpsCounter').css('bottom','0');$teaserFps.find('.hp-product-teaser-fps__bar').css('clip-path','inset(100% 0 0)').css('-webkit-clip-path','inset(100% 0 0)');$teaserFps.find('.jsFpsCounter').html('&nbsp;');}});},_getFpsState:function($this){var $control=$this.$('.jsFpsControl');var state={'game':$control.find('.jsFpsGameSelect').val(),'resolution':$control.find('.jsFpsResolutionSelect').val(),'quality':'ultra'}
return state;},'change .jsFpsControl select':function(e,$this){var $select=$(this);if($select.hasClass('jsFpsGameSelect')){$this.$('.jsFpsGameImg').attr('src',$select.find('option:selected').data('img'))}var $firstTeaser=$this.$('.jsProductTeaserFps').eq(0).parent(),firstTeaserPosition=$firstTeaser.offset().top+$firstTeaser.height(),windowPosition=window.scrollY+window.innerHeight;if(firstTeaserPosition>windowPosition){var fakeLink=document.createElement('a'),offsetCorection=window.innerWidth<960?65:130,offset=window.innerHeight-($firstTeaser.height()+offsetCorection);UIkit.util.on(fakeLink,'scrolled',function(){$this._updateFps($this);});UIkit.scroll(fakeLink,{offset:offset}).scrollTo($firstTeaser);}else{$this._updateFps($this);}}});});